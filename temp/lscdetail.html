<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSC APPICATION</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@4.0.0-rc3/dist/css/adminlte.min.css"
        crossorigin="anonymous" />

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
        }

        .table-container {
            overflow-x: auto;
        }

        .table-fixed-header thead th {
            position: sticky;
            top: 0;
            background-color: #f8fafc;
            z-index: 10;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            line-height: 1;
            color: #fff;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            border-radius: 0.375rem;
        }

        .bg-success {
            background-color: #10B981;
        }

        .bg-danger {
            background-color: #EF4444;
        }

        .bg-primary {
            background-color: #3B82F6;
        }

        .bg-warning {
            background-color: #F59E0B;
            color: #1F2937;
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen p-4 md:p-8">
    <div class="bg-white p-4 md:p-8 rounded-lg shadow-xl">
        <nav class="bg-gray-800 p-4">
            <div class="container mx-auto flex justify-between items-center">
                <div>
                    <a href="#" class="text-white text-lg font-semibold">MSRLS LSC APPLICATION</a>
                </div>
            </div>
        </nav>
        <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home"
                    type="button" role="tab" aria-controls="nav-home" aria-selected="true">Profile</button>
                <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile"
                    type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Service</button>
                <button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact"
                    type="button" role="tab" aria-controls="nav-contact" aria-selected="false">Financial</button>
            </div>
        </nav>

        <div class=" mt-4 tab-content" id="nav-tabContent">
            <!-- Profile -->
            <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                <div class="row p-3 g-3 border-bottom">

                    <div class="col-md-3">
                        <label for="">LSC Name : </label>
                        <input type="text" name="" class="form-control" id="lscName" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for="">LSC established Date : </label>
                        <input type="text" name="" class="form-control" id="LSCestd" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for=""> Operator : </label>
                        <input type="text" name="" class="form-control" id="lscoperator" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for=""> Number of appoint staff engage in LSC : </label>
                        <input type="text" name="" class="form-control" id="noofstaffinLSC" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for="">CLF Name : </label>
                        <input type="text" name="" class="form-control" id="clfname" readonly>
                    </div>

                    <div class="col-md-2">
                        <label for="">CLF Code : </label>
                        <input type="text" name="" class="form-control" id="clfcode" readonly>
                    </div>

                    <div class="col-md-2">
                        <label for=""> CLF Formation date : </label>
                        <input type="text" name="" class="form-control" id="clfestd" readonly>
                    </div>

                    <div class="col-md-5">
                        <label for="">  Contact Person (President/ Secretary/ Responsible person) : </label>
                        <input type="text" name="" class="form-control" id="contactperson" readonly>
                    </div>

                    <div class="col-md-4">
                        <label for=""> Have Building : </label>
                        <input type="text" name="" class="form-control" id="havebuilding" readonly> 
                    </div>

                     <div class="col-md-4">
                        <label for=""> Have furniture : </label>
                        <input type="text" name="" class="form-control" id="havefurniture" readonly>
                    </div>
                    
                    <div class="col-md-4">
                        <label for=""> Provide Service : </label>
                        <input type="text" name="" class="form-control" id="provideservice" readonly>
                    </div>
                </div>

                <!-- address detail -->
                <div class="row p-2 border-bottom">
                    <h1 class="mt-4 mb-4 fw-bold">Address Detail : </h1>

                    <div class="col-md-3">
                        <label for="">District : </label>
                        <input type="text" name="" class="form-control" id="district" readonly>
                    </div>

                     <div class="col-md-3">
                        <label for="">Block : </label>
                        <input type="text" name="" class="form-control" id="block" readonly>
                    </div>

                     <div class="col-md-3">
                        <label for="">Village : </label>
                        <input type="text" name="" class="form-control" id="village" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for="">GP : </label>
                        <input type="text" name="" class="form-control" id="gp" readonly>
                    </div>


                    <div class="col-md-3 mt-2" id="mapsection" style="display:none;">
                        <a id="myLink" href="#" target="_blank" class="btn btn-info"> View in Map</a>
                    </div>
                </div>

                <!-- Account detail -->
                <div class="row p-2 border-bottom">
                    <h1 class="mt-4 mb-4 fw-bold">Account Detail : </h1>

                    <div class="col-md-3">
                        <label for="">Bank Name : </label>
                        <input type="text" name="" class="form-control" id="bankname" readonly>
                    </div>

                     <div class="col-md-3">
                        <label for="">Account Number : </label>
                        <input type="text" name="" class="form-control" id="accountNo" readonly>
                    </div>

                     <div class="col-md-3">
                        <label for="">IFSC : </label>
                        <input type="text" name="" class="form-control" id="ifsc" readonly>
                    </div>

                    <div class="col-md-3">
                        <label for="">Branch : </label>
                        <input type="text" name="" class="form-control" id="branch" readonly>
                    </div>
                </div>   
        </div>
        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
            SERVICES HERE
        </div>
        <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">
            FINANCIAL
        </div>
    </div>

    <center>
        <span class="text-success h1" id="msg"></span>
        <span class="text-danger h1" id="errormsg"></span>
    </center>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/admin-lte@4.0.0-rc3/dist/js/adminlte.min.js"
        crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>



        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxIY2du5C_hZ97tqn9_fthenGyapLq8WKv1Zz6qcGgii1k4eEEb1SOktEUW1ie1YsHiRA/exec";
        let allMeetingData = [];

        //get the parameter from the URL
        function getParameterByName(name) {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            return urlParams.get(name);
        }

        const applicationId = getParameterByName('id'); // lsc id


        async function fetchData() {
            try {
                let nameParam = "CLFDetail";
                const apiUrl = `${WEB_APP_URL}?s=${encodeURIComponent(nameParam)}&id=${encodeURIComponent(applicationId)}`;
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP error! Status: ${response.status} - ${response.statusText}. Response: ${errorText}`);
                }
                const rawData = await response.json();

                if (rawData.message && rawData.message.length > 1) {
                    const headers = rawData.message[0];


                    // put the data here 
                    $("#lscName").val(rawData.message[8]); //LSC NAME 
                    $("#LSCestd").val(rawData.message[10]);
                    $("#lscoperator").val(rawData.message[11]);

                    $("#clfname").val(rawData.message[6]);
                    $("#clfcode").val(rawData.message[5]);
                    $("#clfestd").val(rawData.message[7]);

                    $("#provideservice").val(rawData.message[21]);
                    $("#havefurniture").val(rawData.message[20]);
                    $("#havebuilding").val(rawData.message[19]);
                    $("#contactperson").val(rawData.message[18]);
                    $("#noofstaffinLSC").val(rawData.message[13]);

                    //  address detail
                    $("#district").val(rawData.message[1]);
                    $("#block").val(rawData.message[2]);
                    $("#village").val(rawData.message[3]);
                    $("#gp").val(rawData.message[4]);

                    let lati = rawData.message[22];
                    let long = rawData.message[23];

                    if (lati.length == "")
                    {
                        $("#mapsection").hide();
                    }
                    else{
                        $("#mapsection").show();
                    }

                    const newUrl = `https://www.openstreetmap.org/?mlat=${lati}&mlon=${long}#map=15/${lati}/${long}`;
                    $("#myLink").attr("href", newUrl);

                    // bank detail
                    $("#bankname").val(rawData.message[14]);
                    $("#accountNo").val(rawData.message[15]);
                    $("#ifsc").val(rawData.message[16]);
                    $("#branch").val(rawData.message[17]);


                } else {

                    allMeetingData = [];
                    console.warn("No data or headers found in the fetched response.");
                }

            } catch (error) {
                console.error("Fetch error:", error);
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            fetchData();
        });

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</body>

</html>
